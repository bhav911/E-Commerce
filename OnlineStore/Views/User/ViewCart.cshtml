@model List<OnlineStoreModel.CustomModels.CartModel>

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script>
    function IncrementQuantity(ele, cartID) {
        $.ajax({
            url: "/User/IncrementQuantity?cartID=" + cartID,
            type: "POST",
            dataType: "json",
            success: function (res) {
                debugger
                let tar = $(ele).closest('tr').find('.quantity')[0];
                $(tar).text(parseInt($(tar).text()) + 1);
            },
            error: function (err) {

            }
        })
    }
    function DecrementQuantity(ele, cartID) {
        let element = $(ele).closest('tr').find('.quantity')[0];
        let quantity = parseInt($(element).text());
        if (quantity > 0) {
            $.ajax({
                url: "/User/DecrementQuantity?cartID=" + cartID,
                type: "POST",
                dataType: "json",
                success: function (res) {
                    debugger
                    let tar = $(ele).closest('tr').find('.quantity')[0];
                    $(tar).text(parseInt($(tar).text()) - 1);
                },
                error: function (err) {

                }
            })
        }
    }
</script>


<div>
    <div>
        <h3 class="fw-bold fs-1 text-primary text-center mb-5">Your Cart</h3>
    </div>
    @{
        if (Model != null && Model.Count > 0)
        {
            <table class="table table-borderless">
                <tr>
                    <th>
                        Product
                    </th>
                    <th>
                        Quantity
                    </th>
                    <th>
                        Unit Price
                    </th>
                    <th></th>
                </tr>

                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.productName)
                        </td>
                        <td class="quantity">
                            @Html.DisplayFor(modelItem => item.productQuantity)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.productPrice)
                        </td>
                        <td>
                            <button type="button" class="btn btn-success btn-sm" onclick="IncrementQuantity(this, @item.CartID)">+</button>
                            <button type="button" class="btn btn-danger btn-sm" onclick="DecrementQuantity(this, @item.CartID)">-</button>
                        </td>
                    </tr>
                }
            </table>
            <div class="text-center mt-5">
                <form method="GET" action="/User/GetOrderDetails">
                    <button class="btn btn-primary" type="submit">Proceed To Checkout</button>
                </form>
            </div>
        }
            else
            {
                <div class="d-flex flex-column align-items-center ">
                    <div>
                        <img class="" src="https://img.freepik.com/premium-vector/nothing-here-flat-illustration_418302-77.jpg" />
                    </div>
                    <p class="fw-bold text-center fs-4">Your cart is empty...</p>
                </div>
            }
    }
</div>